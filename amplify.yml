version: 1
frontend:
  phases:
    preBuild:
      commands:
        - cd frontend
        - npm install
        # Install TypeScript globally
        - npm install -g typescript
        # Create environment file
        - |
          cat << EOF > .env
          VITE_API_URL=$API_URL
          VITE_FIREBASE_API_KEY=$FIREBASE_API_KEY
          VITE_FIREBASE_AUTH_DOMAIN=$FIREBASE_AUTH_DOMAIN
          VITE_FIREBASE_PROJECT_ID=$FIREBASE_PROJECT_ID
          VITE_FIREBASE_STORAGE_BUCKET=$FIREBASE_STORAGE_BUCKET
          VITE_FIREBASE_MESSAGING_SENDER_ID=$FIREBASE_MESSAGING_SENDER_ID
          VITE_FIREBASE_APP_ID=$FIREBASE_APP_ID
          EOF
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: frontend/dist
    files:
      - '**/*'
  cache:
    paths:
      - frontend/node_modules/**/*
      - /root/.npm/**/*